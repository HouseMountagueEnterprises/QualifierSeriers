<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horse Racing Data Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
        }
        form {
            max-width: 400px;
            margin: 0 auto;
        }
        label {
            display: block;
            margin-top: 20px;
        }
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            margin-top: 20px;
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

    <h1>Horse Racing Data Form</h1>
    <form id="dataForm" onsubmit="submitData(event)">
        <label for="paymentWallet">Payment Wallet:</label>
        <input type="text" id="paymentWallet" name="paymentWallet" required>

        <label for="payoutWallet">Payout Wallet:</label>
        <input type="text" id="payoutWallet" name="payoutWallet" required>

        <label for="txn">Transaction ID (Txn):</label>
        <input type="text" id="txn" name="txn" required>

        <label for="zedSent">Zed Sent:</label>
        <input type="number" id="zedSent" name="zedSent" required>

        <label for="numHorses">Number of Horses:</label>
        <input type="number" id="numHorses" name="numHorses" required>

        <label for="horseIds">Horse IDs (Comma Separated):</label>
        <input type="text" id="horseIds" name="horseIds" required pattern="^(\d+)(,\d+)*$">

        <button type="submit">Submit</button>
    </form>

    <!-- Firebase App (the core Firebase SDK) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <!-- Firebase Analytics -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-analytics-compat.js"></script>
    <!-- Firebase Firestore -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBeNrXc0i73nsWinc9OE6a-BdlIw_1XCAM",
            authDomain: "horse-data-8ece2.firebaseapp.com",
            projectId: "horse-data-8ece2",
            storageBucket: "horse-data-8ece2.appspot.com",
            messagingSenderId: "93061557603",
            appId: "1:93061557603:web:46c557b65ddefd6f273756",
            measurementId: "G-PQR7KH4E3B"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const analytics = firebase.analytics();
        const db = firebase.firestore();

        // Generate a unique series ID and store it
        const seriesId = generateSeriesId();

        // Function to generate a unique series ID
        function generateSeriesId() {
            // Example using current timestamp (you can replace this with any unique ID generator)
            return 'series-' + new Date().toISOString().replace(/[-:.TZ]/g, '');
        }

        // Function to handle form submission
        function submitData(event) {
            event.preventDefault();

            // Collect form data
            const formData = new FormData(document.getElementById('dataForm'));
            const data = {};
            formData.forEach((value, key) => data[key] = value);

            // Add the series ID to the data
            data.seriesId = seriesId;

            // Send data to Firebase Firestore
            saveDataToFirestore(data);
        }

        // Function to save data to Firebase Firestore
        function saveDataToFirestore(data) {
            // Use the 'qualifierSeriesData' collection
            db.collection('qualifierSeriesData').add(data)
                .then((docRef) => {
                    console.log('Document written with ID: ', docRef.id);
                    alert('Data submitted successfully!');
                    document.getElementById('dataForm').reset();
                })
                .catch((error) => {
                    console.error('Error adding document: ', error);
                    alert('Error submitting data!');
                });
        }

        // Attach form submission handler
        document.getElementById('dataForm').addEventListener('submit', submitData);
    </script>

</body>
</html>
